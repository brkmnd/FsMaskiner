<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <p id="out"></p>
        <script>
var printfn = function(){
    var outfield = document.getElementById("out");
    return function(str){
        outfield.innerHTML += str + "<br>";
        };
    }();





var Stack = function(){
    var stack = {};
    var len = 0;
    var pub = {};
    pub.push = function(v0){
        if(stack[len] !== undefined){
            stack[len].val = v0;
        }
        else {
            stack[len] = {val:v0};
            }
        len++;
        };
    pub.pop = function(){
        if(len > 0){
            len--;
            return stack[len].val;
            }
        return null;
        };
    pub.popN = function(n,f){
        var n0 = n;
        while(len > 0 && n0 > 0){
            f(this.pop());
            n0--;
            }
        };
    pub.peek = function(){
        if(len > 0){
            return stack[len - 1].val;
            }
        return null;
        };
    pub.foreach = function(f){
        var i = len - 1;
        while(i >= 0){
            f(stack[i].val);
            i--;
            }
        };
    pub.count = function(){
        return len;
        };
    return pub;
    };
var actionType = {
    shift:function(d){
        return {type:"shift",v:d};
        },
    reduce:function(d){
        return {type:"reduce",v:d};
        },
    accept:function(d){
        return {type:"accept",v:null};
        },
    error:function(msg){
        return {type:"error",v:msg};
        },
    none:function(){
        return {type:"none",v:null};
        },
    some:function(v){
        return {type:"some",v:v}
        }
    };
var isSome = function(m){
    return m.t === "some";
    };
var isNone = function(m){
    return m.t === "none";
    };
var _token = function(m,o){
    //m.tv = token val
    //m.t = some/none
    //m.v = value if some, else null
    if(o[m.tv] !== undefined){
        return o[m.tv](m.tv,m.v);
        }
    };
var addToken2tree = function(tree,node){
    _token(node,{
        "float":function(tokenV,capV){ /* do something to tree */ },
        "id":function(tokenV,capV){ /* do something to tree */ },
        "int":function(tokenV,capV){ /* do something to tree */ }
       });
    return tree;
    };
var errors = {
    syntax:function(pos,msg){
        return "syntax error at (" + pos.y + "," + pos.x + "):" + msg;
        },
    garbage:function(g){
        return "garbage in expression: '" + g + "'";
        }
    };
var productions_fun = {
    //[0] __ -> Exp' 
    0:function(tree){ return tree; },
    //[1] Exp' -> Exp 
    1:function(tree){ return tree; },
    //[2] Exp -> Exp minus Exp 
    2:function(tree){ return tree; },
    //[3] Exp -> Exp plus Exp 
    3:function(tree){ return tree; },
    //[4] Exp -> Exp times Exp 
    4:function(tree){ return tree; },
    //[5] Exp -> Exp divide Exp 
    5:function(tree){ return tree; },
    //[6] Exp -> Exp power Exp 
    6:function(tree){ return tree; },
    //[7] Exp -> Call 
    7:function(tree){ return tree; },
    //[8] Exp -> Atom 
    8:function(tree){ return tree; },
    //[9] Exp -> minus Exp 
    9:function(tree){ return tree; },
    //[10] Call -> id lpar Args rpar 
    10:function(tree){ return tree; },
    //[11] Args -> Arg 
    11:function(tree){ return tree; },
    //[12] Args -> Arg comma Args 
    12:function(tree){ return tree; },
    //[13] Arg -> Atom 
    13:function(tree){ return tree; },
    //[14] Arg -> Call 
    14:function(tree){ return tree; },
    //[15] Arg -> 
    15:function(tree){ return tree; },
    //[16] Atom -> lpar Exp rpar 
    16:function(tree){ return tree; },
    //[17] Atom -> float 
    17:function(tree){ return tree; },
    //[18] Atom -> int 
    18:function(tree){ return tree; }
    };
var productions_str = {
    0:{prod:"__",rside:[ "Exp'"]},
    1:{prod:"Exp'",rside:[ "Exp"]},
    2:{prod:"Exp",rside:[ "Exp","minus","Exp"]},
    3:{prod:"Exp",rside:[ "Exp","plus","Exp"]},
    4:{prod:"Exp",rside:[ "Exp","times","Exp"]},
    5:{prod:"Exp",rside:[ "Exp","divide","Exp"]},
    6:{prod:"Exp",rside:[ "Exp","power","Exp"]},
    7:{prod:"Exp",rside:[ "Call"]},
    8:{prod:"Exp",rside:[ "Atom"]},
    9:{prod:"Exp",rside:[ "minus","Exp"]},
    10:{prod:"Call",rside:[ "id","lpar","Args","rpar"]},
    11:{prod:"Args",rside:[ "Arg"]},
    12:{prod:"Args",rside:[ "Arg","comma","Args"]},
    13:{prod:"Arg",rside:[ "Atom"]},
    14:{prod:"Arg",rside:[ "Call"]},
    15:{prod:"Arg",rside:[]},
    16:{prod:"Atom",rside:[ "lpar","Exp","rpar"]},
    17:{prod:"Atom",rside:[ "float"]},
    18:{prod:"Atom",rside:[ "int"]}
    };
var lexer = function(inStr){
    var rxStr =
        "(,)|"+
        "(\\/)|"+
        "([0-9]*\\.[0-9]+)|"+
        "([a-zA-Z]+)|"+
        "([0-9]+)|"+
        "(\\()|"+
        "(-)|"+
        "(\\+)|"+
        "(\\^)|"+
        "(\\))|"+
        "(\\*)|"+
        "\n|"+
        "\r|"+
        "\t|"+
        " ";
    var rx = new RegExp(rxStr,"g");
    var retI = 0;
    var retval = {};
    var linepos = {lnr:1,start:0};
    var resStr = inStr.replace(rx,
        function(a,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,posX){
            if(a === "\n"){
                linepos.lnr++;
                linepos.start = posX;
                }
            if(typeof i1 !== "undefined"){
                retval[retI] = {t:"none",tv:"comma",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i2 !== "undefined"){
                retval[retI] = {t:"none",tv:"divide",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i3 !== "undefined"){
                retval[retI] = {t:"some",tv:"float",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i4 !== "undefined"){
                retval[retI] = {t:"some",tv:"id",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i5 !== "undefined"){
                retval[retI] = {t:"some",tv:"int",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i6 !== "undefined"){
                retval[retI] = {t:"none",tv:"lpar",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i7 !== "undefined"){
                retval[retI] = {t:"none",tv:"minus",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i8 !== "undefined"){
                retval[retI] = {t:"none",tv:"plus",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i9 !== "undefined"){
                retval[retI] = {t:"none",tv:"power",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i10 !== "undefined"){
                retval[retI] = {t:"none",tv:"rpar",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            else if(typeof i11 !== "undefined"){
                retval[retI] = {t:"none",tv:"times",posX:posX - linepos.start,posY:linepos.lnr};
                retI++;
                }
            return "";
            }
        );
    if(resStr !== ""){
        retval["__success"] = false;
        retval["__res"] = resStr;
        }
    else {
        retval[retI] = {t:"none",v:null,tv:"$"};
        }
    return retval;
    };
var actionTable = {
    0:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    1:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.reduce(8),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(8),
        "plus":actionType.reduce(8),
        "power":actionType.reduce(8),
        "rpar":actionType.reduce(8),
        "times":actionType.reduce(8),
        "$":actionType.reduce(8)
        },
    2:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.reduce(7),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(7),
        "plus":actionType.reduce(7),
        "power":actionType.reduce(7),
        "rpar":actionType.reduce(7),
        "times":actionType.reduce(7),
        "$":actionType.reduce(7)
        },
    3:{
        "comma":actionType.error("expected 'operator','power','times','eoi', but given 'comma'"),
        "divide":actionType.shift(10),
        "float":actionType.error("expected 'operator','power','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','times','eoi', but given 'parentheses'"),
        "minus":actionType.shift(11),
        "plus":actionType.shift(12),
        "power":actionType.shift(13),
        "rpar":actionType.error("expected 'operator','power','times','eoi', but given 'parentheses'"),
        "times":actionType.shift(14),
        "$":actionType.reduce(1)
        },
    4:{
        "comma":actionType.error("expected 'eoi', but given 'comma'"),
        "divide":actionType.error("expected 'eoi', but given 'operator'"),
        "float":actionType.error("expected 'eoi', but given 'operand'"),
        "id":actionType.error("expected 'eoi', but given 'operand'"),
        "int":actionType.error("expected 'eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'eoi', but given 'parentheses'"),
        "minus":actionType.error("expected 'eoi', but given 'operator'"),
        "plus":actionType.error("expected 'eoi', but given 'operator'"),
        "power":actionType.error("expected 'eoi', but given 'power'"),
        "rpar":actionType.error("expected 'eoi', but given 'parentheses'"),
        "times":actionType.error("expected 'eoi', but given 'times'"),
        "$":actionType.accept()
        },
    5:{
        "comma":actionType.reduce(17),
        "divide":actionType.reduce(17),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(17),
        "plus":actionType.reduce(17),
        "power":actionType.reduce(17),
        "rpar":actionType.reduce(17),
        "times":actionType.reduce(17),
        "$":actionType.reduce(17)
        },
    6:{
        "comma":actionType.error("expected 'parentheses', but given 'comma'"),
        "divide":actionType.error("expected 'parentheses', but given 'operator'"),
        "float":actionType.error("expected 'parentheses', but given 'operand'"),
        "id":actionType.error("expected 'parentheses', but given 'operand'"),
        "int":actionType.error("expected 'parentheses', but given 'operand'"),
        "lpar":actionType.shift(15),
        "minus":actionType.error("expected 'parentheses', but given 'operator'"),
        "plus":actionType.error("expected 'parentheses', but given 'operator'"),
        "power":actionType.error("expected 'parentheses', but given 'power'"),
        "rpar":actionType.error("expected 'parentheses', but given 'parentheses'"),
        "times":actionType.error("expected 'parentheses', but given 'times'"),
        "$":actionType.error("expected 'parentheses', but given '$'")
        },
    7:{
        "comma":actionType.reduce(18),
        "divide":actionType.reduce(18),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(18),
        "plus":actionType.reduce(18),
        "power":actionType.reduce(18),
        "rpar":actionType.reduce(18),
        "times":actionType.reduce(18),
        "$":actionType.reduce(18)
        },
    8:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    9:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    10:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    11:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    12:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    13:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    14:{
        "comma":actionType.error("expected 'operand','parentheses','operator', but given 'comma'"),
        "divide":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.shift(9),
        "plus":actionType.error("expected 'operand','parentheses','operator', but given 'operator'"),
        "power":actionType.error("expected 'operand','parentheses','operator', but given 'power'"),
        "rpar":actionType.error("expected 'operand','parentheses','operator', but given 'parentheses'"),
        "times":actionType.error("expected 'operand','parentheses','operator', but given 'times'"),
        "$":actionType.error("expected 'operand','parentheses','operator', but given '$'")
        },
    15:{
        "comma":actionType.reduce(15),
        "divide":actionType.reduce(15),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.reduce(15),
        "plus":actionType.reduce(15),
        "power":actionType.reduce(15),
        "rpar":actionType.reduce(15),
        "times":actionType.reduce(15),
        "$":actionType.reduce(15)
        },
    16:{
        "comma":actionType.error("expected 'operator','power','parentheses','times', but given 'comma'"),
        "divide":actionType.shift(10),
        "float":actionType.error("expected 'operator','power','parentheses','times', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times', but given 'parentheses'"),
        "minus":actionType.shift(11),
        "plus":actionType.shift(12),
        "power":actionType.shift(13),
        "rpar":actionType.shift(27),
        "times":actionType.shift(14),
        "$":actionType.error("expected 'operator','power','parentheses','times', but given '$'")
        },
    17:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.shift(10),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(9),
        "plus":actionType.reduce(9),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(9),
        "times":actionType.shift(14),
        "$":actionType.reduce(9)
        },
    18:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.reduce(5),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(5),
        "plus":actionType.reduce(5),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(5),
        "times":actionType.reduce(5),
        "$":actionType.reduce(5)
        },
    19:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.shift(10),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(2),
        "plus":actionType.reduce(2),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(2),
        "times":actionType.shift(14),
        "$":actionType.reduce(2)
        },
    20:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.shift(10),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(3),
        "plus":actionType.reduce(3),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(3),
        "times":actionType.shift(14),
        "$":actionType.reduce(3)
        },
    21:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.reduce(6),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(6),
        "plus":actionType.reduce(6),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(6),
        "times":actionType.reduce(6),
        "$":actionType.reduce(6)
        },
    22:{
        "comma":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'comma'"),
        "divide":actionType.reduce(4),
        "float":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(4),
        "plus":actionType.reduce(4),
        "power":actionType.shift(13),
        "rpar":actionType.reduce(4),
        "times":actionType.reduce(4),
        "$":actionType.reduce(4)
        },
    23:{
        "comma":actionType.shift(28),
        "divide":actionType.error("expected 'comma','parentheses', but given 'operator'"),
        "float":actionType.error("expected 'comma','parentheses', but given 'operand'"),
        "id":actionType.error("expected 'comma','parentheses', but given 'operand'"),
        "int":actionType.error("expected 'comma','parentheses', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','parentheses', but given 'parentheses'"),
        "minus":actionType.error("expected 'comma','parentheses', but given 'operator'"),
        "plus":actionType.error("expected 'comma','parentheses', but given 'operator'"),
        "power":actionType.error("expected 'comma','parentheses', but given 'power'"),
        "rpar":actionType.reduce(11),
        "times":actionType.error("expected 'comma','parentheses', but given 'times'"),
        "$":actionType.error("expected 'comma','parentheses', but given '$'")
        },
    24:{
        "comma":actionType.error("expected 'parentheses', but given 'comma'"),
        "divide":actionType.error("expected 'parentheses', but given 'operator'"),
        "float":actionType.error("expected 'parentheses', but given 'operand'"),
        "id":actionType.error("expected 'parentheses', but given 'operand'"),
        "int":actionType.error("expected 'parentheses', but given 'operand'"),
        "lpar":actionType.error("expected 'parentheses', but given 'parentheses'"),
        "minus":actionType.error("expected 'parentheses', but given 'operator'"),
        "plus":actionType.error("expected 'parentheses', but given 'operator'"),
        "power":actionType.error("expected 'parentheses', but given 'power'"),
        "rpar":actionType.shift(29),
        "times":actionType.error("expected 'parentheses', but given 'times'"),
        "$":actionType.error("expected 'parentheses', but given '$'")
        },
    25:{
        "comma":actionType.reduce(13),
        "divide":actionType.reduce(13),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(13),
        "plus":actionType.reduce(13),
        "power":actionType.reduce(13),
        "rpar":actionType.reduce(13),
        "times":actionType.reduce(13),
        "$":actionType.reduce(13)
        },
    26:{
        "comma":actionType.reduce(14),
        "divide":actionType.reduce(14),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(14),
        "plus":actionType.reduce(14),
        "power":actionType.reduce(14),
        "rpar":actionType.reduce(14),
        "times":actionType.reduce(14),
        "$":actionType.reduce(14)
        },
    27:{
        "comma":actionType.reduce(16),
        "divide":actionType.reduce(16),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(16),
        "plus":actionType.reduce(16),
        "power":actionType.reduce(16),
        "rpar":actionType.reduce(16),
        "times":actionType.reduce(16),
        "$":actionType.reduce(16)
        },
    28:{
        "comma":actionType.reduce(15),
        "divide":actionType.reduce(15),
        "float":actionType.shift(5),
        "id":actionType.shift(6),
        "int":actionType.shift(7),
        "lpar":actionType.shift(8),
        "minus":actionType.reduce(15),
        "plus":actionType.reduce(15),
        "power":actionType.reduce(15),
        "rpar":actionType.reduce(15),
        "times":actionType.reduce(15),
        "$":actionType.reduce(15)
        },
    29:{
        "comma":actionType.reduce(10),
        "divide":actionType.reduce(10),
        "float":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "id":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "int":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'operand'"),
        "lpar":actionType.error("expected 'comma','operator','power','parentheses','times','eoi', but given 'parentheses'"),
        "minus":actionType.reduce(10),
        "plus":actionType.reduce(10),
        "power":actionType.reduce(10),
        "rpar":actionType.reduce(10),
        "times":actionType.reduce(10),
        "$":actionType.reduce(10)
        },
    30:{
        "comma":actionType.error("expected 'parentheses', but given 'comma'"),
        "divide":actionType.error("expected 'parentheses', but given 'operator'"),
        "float":actionType.error("expected 'parentheses', but given 'operand'"),
        "id":actionType.error("expected 'parentheses', but given 'operand'"),
        "int":actionType.error("expected 'parentheses', but given 'operand'"),
        "lpar":actionType.error("expected 'parentheses', but given 'parentheses'"),
        "minus":actionType.error("expected 'parentheses', but given 'operator'"),
        "plus":actionType.error("expected 'parentheses', but given 'operator'"),
        "power":actionType.error("expected 'parentheses', but given 'power'"),
        "rpar":actionType.reduce(12),
        "times":actionType.error("expected 'parentheses', but given 'times'"),
        "$":actionType.error("expected 'parentheses', but given '$'")
        }
    };
var gotoTable = {
    0:{
        "Exp'":actionType.some(4),
        "Exp":actionType.some(3),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    1:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    2:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    3:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    4:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    5:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    6:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    7:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    8:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(16),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    9:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(17),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    10:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(18),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    11:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(19),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    12:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(20),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    13:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(21),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    14:{
        "Exp'":actionType.none(),
        "Exp":actionType.some(22),
        "Call":actionType.some(2),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.some(1)
        },
    15:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.some(26),
        "Args":actionType.some(24),
        "Arg":actionType.some(23),
        "Atom":actionType.some(25)
        },
    16:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    17:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    18:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    19:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    20:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    21:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    22:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    23:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    24:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    25:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    26:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    27:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    28:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.some(26),
        "Args":actionType.some(30),
        "Arg":actionType.some(23),
        "Atom":actionType.some(25)
        },
    29:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        },
    30:{
        "Exp'":actionType.none(),
        "Exp":actionType.none(),
        "Call":actionType.none(),
        "Args":actionType.none(),
        "Arg":actionType.none(),
        "Atom":actionType.none()
        }
    };
var parser = function(tokens){
    var sStack = new Stack();
    var tree = new Stack();
    var i = 0;
    var parsing = true;
    if(tokens["__success"] !== undefined && !tokens["__success"]){
        tree.push({error:true,msg:errors.garbage(tokens["__res"])});
        return tree;
        }
    sStack.push(0);
    while(parsing){
        var s = sStack.peek();
        var a = tokens[i].tv;
        var entry = actionTable[s][a];
        switch(entry.type){
            case "shift":
                sStack.push(entry.v);
                tree = addToken2tree(tree,tokens[i]);
                i += 1;
                break;
            case "reduce":
                var r = entry.v;
                var prod = productions_str[r];
                var rSide = prod.rside;
                var pName = prod.prod;
                var pFun = productions_fun[r];
                sStack.popN(rSide.length,function(x){});
                sStack.push(gotoTable[sStack.peek()][pName].v);
                tree = pFun(tree);
                break;
            case "accept":
                return tree;
            case "error":
                var token = tokens[i];
                tree.push({error:true,msg:errors.syntax({x:token.posX,y:token.posY},entry.v)});
                return tree;
            }
        }
    };

printfn("start");
var a1 = "1 * (2 + 3) ^ 4 - 5 / 6 * * æøå pow(2,4)";
var a1_lexed = lexer(a1);
var a1_parsed = parser(a1_lexed);
var t = a1_parsed.peek();
if(t.error !== undefined && t.error){
    alert(t.msg)
    }
printfn("done")
        
        </script>
    </body>
</html>
